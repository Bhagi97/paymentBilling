<div class="page-title">
                            <div class="title_left">
                                  <h3 style="margin-left:20px;">Treatments</h3>
                            </div>
                             <div class="title_right">
                                <div class="col-md-5 col-sm-5 col-xs-12 form-group pull-right ">
                                    <div class="input-group">
                                        <select id="q" class="form-control">
                                          {% for c in treatments %}
                                            <option value="{{c.name}}">{{c.name}}</option>
                                          {% endfor %}
                                        </select>
                                      <script>
                                        document.getElementById("q").selectedIndex = -1;
                                      </script>
                                    </div>

                                </div>
                            </div>
</div>

<div class="row">
            <div class="col-md-4 col-sm-4 col-xs-12">
                  <!-- -->
                  <div class="x_panel">
                  <div class="x_title">
                    <h2><small>View Treatments</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <!-- -->
                  <div id="collapseOne1" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                          <div class="panel-body">
                            <table id="datatable" class="table table-striped">
                              <thead>
                                <tr>
                                  <th>Treatment Name</th>
                                </tr>
                              </thead>
                              <tbody>
                              {% for c in treatments %}
                                <tr>
                                  <td><a href="#" onclick="getdetails('{{c.name}}')">{{c.name}}</a></td>
                                </tr>
                              {% endfor %}
                              </tbody>
                            </table>
                          </div>
                        </div>
                  </div>
                </div>
              </div>

            <div class="col-md-8 col-sm-8 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                    <h2><small>Add/Edit treatment details</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <br />
                    <form id="treatmententry" method="post"  action="treatmententry.html" data-parsley-validate class="form-horizontal form-label-left"> {% csrf_token %}
                      <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="id">Treatment ID
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                          <input type="text" id="id" name="id" placeholder="Leave blank for new treatment" class="form-control col-md-7 col-xs-12">
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="name">Name <span class="required">*</span>
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                          <input type="text" id="name" name="name" required="required" class="form-control col-md-7 col-xs-12">
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="duration">Duration (Minutes)
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                          <input type="text" id="duration" name="duration" class="form-control col-md-7 col-xs-12">
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="remarks">Remarks
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                          <input type="text" id="remarks" name="remarks" class="form-control col-md-7 col-xs-12">
                        </div>
                      </div>

                      <div class="ln_solid"></div>
                      <div class="form-group">
                        <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                          <button type="button" class="buttonNext btn btn-danger" onclick="delete_treatmentmaster()">Delete</button>
						  <button class="btn btn-primary" type="reset">Reset</button>
                          <button type="submit" class="btn btn-success">Submit</button>
                        </div>
                      </div>

                    </form>
                  </div>
                </div>
              </div>
            </div>

{% include 'app/mydir/common/successfulinsertion.html' %}

<script>

  function launchajax(metalist)
  {
    $.ajax({
        url: '/ajax/gettreatmentmaster/',
        data: {
          'metalist': metalist,
        },
        dataType: 'json',
        success: function (data) {
            document.getElementById("id").value = data.treatment.id;
            document.getElementById("name").value = data.treatment.name;
            document.getElementById("duration").value = data.treatment.duration;
            $('[name=bodypart]').val(data.treatment.body_part);
            document.getElementById("remarks").value = data.treatment.remarks;
        }
      });
  }


  $(document).on('change','#q',function(){
      metalist = [];
      metalist.push(document.getElementById("q").value);
      launchajax(metalist);
  });

  function getdetails(sname)
     {
        $("#q").val(sname);
        var metalist = [];
        metalist.push(sname);
        launchajax(metalist);
     }

     $(document).ready(function() {
      $('#datatable').dataTable({bFilter: false, bInfo: false, bLengthChange: false});
     } );

  function delete_treatmentmaster()
    {
        del_id = document.getElementById("id").value;
        if(del_id=='')
            { alert("No treatment selected"); return; }
        $.ajax({
            url: '/ajax/deletetreatmentmaster/',
            data: {
              'del_id': del_id,
              },
            dataType: 'json',
            async: false,
            success: function (data) {
                if (data.success==1)
                    { document.getElementById("message").innerHTML = 'Successfully deleted treatment';
                      var x = document.getElementById('notify2');
                      x.style.display = 'block';
                      setTimeout(function(){ location.reload(); }, 2000);
                    }
                else
                    {  document.getElementById("message-f").innerHTML = 'Failed to delete treatment - '+data.error;
                       var x = document.getElementById('notify-f2');
                       x.style.display = 'block';
                    }
              }
        });
    }
</script>